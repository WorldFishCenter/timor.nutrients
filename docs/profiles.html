<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Timor SSF nutrient profiles | Modelling scenarios for nutrient-sensitive fisheries management</title>
  <meta name="description" content="5 Timor SSF nutrient profiles | Modelling scenarios for nutrient-sensitive fisheries management" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Timor SSF nutrient profiles | Modelling scenarios for nutrient-sensitive fisheries management" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="WorldFishCenter/timor.nutrients" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Timor SSF nutrient profiles | Modelling scenarios for nutrient-sensitive fisheries management" />
  
  
  

<meta name="author" content="Lore" />


<meta name="date" content="2023-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distribution.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelling scenarios for nutrient-sensitive fisheries managemente</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Content</a></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#catch-weight-and-nutrional-content"><i class="fa fa-check"></i><b>2.1</b> Catch weight and nutrional content</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="highlight.html"><a href="highlight.html"><i class="fa fa-check"></i><b>3</b> Highlight statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="highlight.html"><a href="highlight.html#timor-est-ssf-nutritional-scenario"><i class="fa fa-check"></i><b>3.1</b> Timor-Est SSF nutritional scenario</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="distribution.html"><a href="distribution.html"><i class="fa fa-check"></i><b>4</b> Nutrients distribution</a>
<ul>
<li class="chapter" data-level="4.1" data-path="distribution.html"><a href="distribution.html#fish-groups"><i class="fa fa-check"></i><b>4.1</b> Fish groups</a></li>
<li class="chapter" data-level="4.2" data-path="distribution.html"><a href="distribution.html#habitat-and-gear-type"><i class="fa fa-check"></i><b>4.2</b> Habitat and gear type</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="profiles.html"><a href="profiles.html"><i class="fa fa-check"></i><b>5</b> Timor SSF nutrient profiles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="profiles.html"><a href="profiles.html#methods"><i class="fa fa-check"></i><b>5.1</b> Methods</a></li>
<li class="chapter" data-level="5.2" data-path="profiles.html"><a href="profiles.html#results"><i class="fa fa-check"></i><b>5.2</b> Results</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="profiles.html"><a href="profiles.html#clusters"><i class="fa fa-check"></i><b>5.2.1</b> Clusters</a></li>
<li class="chapter" data-level="5.2.2" data-path="profiles.html"><a href="profiles.html#xgboost-model"><i class="fa fa-check"></i><b>5.2.2</b> XGBoost model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelling scenarios for nutrient-sensitive fisheries management</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="profiles" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Timor SSF nutrient profiles<a href="profiles.html#profiles" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="methods" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Methods<a href="profiles.html#methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we identified recurrent nutritional profiles based on <a href="data.html#data">RC data</a>. We aimed to determine the most appropriate number of distinct groups, or “clusters,” present in our dataset. To achieve this, we used the total within sum of square (WSS) to identify the point at which grouping additional data points together does not significantly improve the clarity of the clustering. Once we established the optimal number of clusters, we applied the <a href="https://uc-r.github.io/kmeans_clustering#:~:text=The%20gap%20statistic%20compares%20the,simulations%20of%20the%20sampling%20process.">K-means</a> clustering method. This is a widely-used technique that organizes data into clusters based on similarity. In our case, we grouped fishing trips together if they showed similar levels of nutrient concentrations. By doing this, we were able to observe patterns and categorize the trips according to their nutritional profiles.</p>
<p>Then we performed a ML model to assess whether nutritional profiles were predicatable by fishing strategy. We utilized a machine learning approach, specifically employing the XGBoost algorithm. XGBoost was chosen due to its capability in handling categorical variables, such as habitat, gear type, and vessel type, which are prominent in our dataset. Additionally, its proficiency in handling categorical variables and enabling a detailed examination of predictor importance in relation to the nutritional profiles classification aligned well with our requirement to model the clusters as a categorical outcome variable.</p>
<p>The selection of XGBoost was also influenced by its inherent mechanisms that mitigate overfitting, an important consideration to enhance the reliability of our predictive model. The algorithm’s feature importance functionality provided an added benefit, allowing for an examination of which predictors exert the most influence on the nutritional profile clusters. This aspect was pertinent to our objective of exploring the association between fishing strategies and nutritional outcomes.</p>
</div>
<div id="results" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Results<a href="profiles.html#results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="clusters" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Clusters<a href="profiles.html#clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="profiles.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="profiles.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="profiles.html#cb6-3" tabindex="-1"></a>df <span class="ot">&lt;-</span></span>
<span id="cb6-4"><a href="profiles.html#cb6-4" tabindex="-1"></a>  timor.nutrients<span class="sc">::</span>kobo_trips <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="profiles.html#cb6-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="profiles.html#cb6-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Selenium_mu) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="profiles.html#cb6-7" tabindex="-1"></a>  <span class="fu">rename_nutrients_mu</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="profiles.html#cb6-8" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(zinc<span class="sc">:</span>vitaminA), <span class="at">names_to =</span> <span class="st">&quot;nutrient&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;kg&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="profiles.html#cb6-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(RDI_tab, <span class="at">by =</span> <span class="st">&quot;nutrient&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="profiles.html#cb6-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb6-11"><a href="profiles.html#cb6-11" tabindex="-1"></a>    <span class="at">nutrients_kg_per_kg =</span> kg <span class="sc">/</span> weight, <span class="co"># standardize nutrients for 1 kg of catch</span></span>
<span id="cb6-12"><a href="profiles.html#cb6-12" tabindex="-1"></a>    <span class="at">nutrients_g_per_kg =</span> nutrients_kg_per_kg <span class="sc">*</span> <span class="dv">1000</span>, <span class="co"># convert stand nutrients in grams</span></span>
<span id="cb6-13"><a href="profiles.html#cb6-13" tabindex="-1"></a>    <span class="at">people_rni_kg =</span> nutrients_g_per_kg <span class="sc">/</span> conv_factor</span>
<span id="cb6-14"><a href="profiles.html#cb6-14" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="profiles.html#cb6-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(landing_id, reporting_region, landing_date, vessel_type, habitat, gear_type, nutrient, people_rni_kg) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="profiles.html#cb6-16" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;nutrient&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;people_rni_kg&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="profiles.html#cb6-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">quarter =</span> lubridate<span class="sc">::</span><span class="fu">quarter</span>(landing_date)) <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="profiles.html#cb6-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(landing_date, quarter, dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="profiles.html#cb6-19" tabindex="-1"></a>  <span class="co"># dplyr::filter(landing_period &gt; &quot;2019-01-01&quot;) %&gt;%</span></span>
<span id="cb6-20"><a href="profiles.html#cb6-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(landing_date, quarter, vessel_type, habitat, gear_type) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="profiles.html#cb6-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(is.numeric, <span class="sc">~</span> <span class="fu">median</span>(.x, <span class="at">na.rm =</span> T))) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="profiles.html#cb6-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="profiles.html#cb6-23" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb6-24"><a href="profiles.html#cb6-24" tabindex="-1"></a></span>
<span id="cb6-25"><a href="profiles.html#cb6-25" tabindex="-1"></a><span class="co"># factoextra::fviz_nbclust(df[ ,5:10], kmeans, method = &quot;wss&quot;)</span></span>
<span id="cb6-26"><a href="profiles.html#cb6-26" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">555</span>)</span>
<span id="cb6-27"><a href="profiles.html#cb6-27" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df[, <span class="dv">6</span><span class="sc">:</span><span class="dv">11</span>], <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">500</span>)</span>
<span id="cb6-28"><a href="profiles.html#cb6-28" tabindex="-1"></a></span>
<span id="cb6-29"><a href="profiles.html#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="profiles.html#cb6-30" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_cluster</span>(k2,</span>
<span id="cb6-31"><a href="profiles.html#cb6-31" tabindex="-1"></a>  <span class="at">data =</span> df[, <span class="dv">6</span><span class="sc">:</span><span class="dv">11</span>],</span>
<span id="cb6-32"><a href="profiles.html#cb6-32" tabindex="-1"></a>  <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;point&quot;</span>),</span>
<span id="cb6-33"><a href="profiles.html#cb6-33" tabindex="-1"></a>  <span class="at">shape =</span> <span class="dv">19</span></span>
<span id="cb6-34"><a href="profiles.html#cb6-34" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb6-35"><a href="profiles.html#cb6-35" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-36"><a href="profiles.html#cb6-36" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb6-37"><a href="profiles.html#cb6-37" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb6-38"><a href="profiles.html#cb6-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-39"><a href="profiles.html#cb6-39" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="Timor-nutrient-sensitive-fisheries-management_files/figure-html/unnamed-chunk-4-1.png" alt="Cluster analysis of nutrient profiles using k-means clustering. The scatter plot visualizes the distribution of data points in a two-dimensional space defined by the first two principal components which explain 39% and 26% of the variance. The convex hulls represent the boundaries of each cluster, providing a visual guide to the cluster density and separation." width="768" />
<p class="caption">
Figure 5.1: Cluster analysis of nutrient profiles using k-means clustering. The scatter plot visualizes the distribution of data points in a two-dimensional space defined by the first two principal components which explain 39% and 26% of the variance. The convex hulls represent the boundaries of each cluster, providing a visual guide to the cluster density and separation.
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="profiles.html#cb7-1" tabindex="-1"></a>clusterdf <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="profiles.html#cb7-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb7-3"><a href="profiles.html#cb7-3" tabindex="-1"></a>    <span class="at">clusters =</span> <span class="fu">as.character</span>(k2<span class="sc">$</span>cluster),</span>
<span id="cb7-4"><a href="profiles.html#cb7-4" tabindex="-1"></a>    df</span>
<span id="cb7-5"><a href="profiles.html#cb7-5" tabindex="-1"></a>  )</span>
<span id="cb7-6"><a href="profiles.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="profiles.html#cb7-7" tabindex="-1"></a>clusterdf <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="profiles.html#cb7-8" tabindex="-1"></a>  <span class="co"># dplyr::select(-weight) %&gt;%</span></span>
<span id="cb7-9"><a href="profiles.html#cb7-9" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(zinc<span class="sc">:</span>vitaminA)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="profiles.html#cb7-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(clusters, name) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="profiles.html#cb7-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">median</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="profiles.html#cb7-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">reorder</span>(clusters, value), <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="profiles.html#cb7-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-14"><a href="profiles.html#cb7-14" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb7-15"><a href="profiles.html#cb7-15" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb7-16"><a href="profiles.html#cb7-16" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="profiles.html#cb7-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="profiles.html#cb7-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;N. individuals meeting RNI per 1kg of catch&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Cluster number&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="Timor-nutrient-sensitive-fisheries-management_files/figure-html/unnamed-chunk-5-1.png" alt="Distribution of nutrient adequacy across k-means clusters. The bar chart represents the number of individuals meeting the Recommended Nutrient Intake (RNI) per 1kg of catch for each nutrient within different clusters. Each bar is segmented into six categories corresponding to the nutrients analyzed: calcium (dark purple), iron (blue), omega-3 (green), protein (teal), vitamin A (dark teal), and zinc (yellow). Clusters are labeled on the y-axis, indicating distinct groupings based on nutrient profile similarities derived from the cluster analysis. The x-axis quantifies the number of individuals who meet the RNI, highlighting the variation in nutritional fulfillment across clusters." width="576" />
<p class="caption">
Figure 5.2: Distribution of nutrient adequacy across k-means clusters. The bar chart represents the number of individuals meeting the Recommended Nutrient Intake (RNI) per 1kg of catch for each nutrient within different clusters. Each bar is segmented into six categories corresponding to the nutrients analyzed: calcium (dark purple), iron (blue), omega-3 (green), protein (teal), vitamin A (dark teal), and zinc (yellow). Clusters are labeled on the y-axis, indicating distinct groupings based on nutrient profile similarities derived from the cluster analysis. The x-axis quantifies the number of individuals who meet the RNI, highlighting the variation in nutritional fulfillment across clusters.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="profiles.html#cb8-1" tabindex="-1"></a><span class="co"># generate data for ML model</span></span>
<span id="cb8-2"><a href="profiles.html#cb8-2" tabindex="-1"></a>clusterdf <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="profiles.html#cb8-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">habitat_gear =</span> <span class="fu">paste</span>(habitat, gear_type, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="profiles.html#cb8-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(quarter, habitat_gear, habitat, gear_type, vessel_type, <span class="at">cluster =</span> clusters) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="profiles.html#cb8-5" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_rds</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;model-outputs&quot;</span>, <span class="at">package =</span> <span class="st">&quot;timor.nutrients&quot;</span>), <span class="st">&quot;/ml_data.rds&quot;</span>))</span></code></pre></div>
</div>
<div id="xgboost-model" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> XGBoost model<a href="profiles.html#xgboost-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="profiles.html#cb9-1" tabindex="-1"></a>df_field <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="profiles.html#cb9-2" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_rds</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;model-outputs&quot;</span>, <span class="at">package =</span> <span class="st">&quot;timor.nutrients&quot;</span>), <span class="st">&quot;/ml_data.rds&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="profiles.html#cb9-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(as.factor)</span>
<span id="cb9-4"><a href="profiles.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="profiles.html#cb9-5" tabindex="-1"></a><span class="co"># DataExplorer::plot_intro(df)</span></span>
<span id="cb9-6"><a href="profiles.html#cb9-6" tabindex="-1"></a><span class="co"># DataExplorer::plot_bar(df)</span></span>
<span id="cb9-7"><a href="profiles.html#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="profiles.html#cb9-8" tabindex="-1"></a><span class="co"># splitting and resampling</span></span>
<span id="cb9-9"><a href="profiles.html#cb9-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb9-10"><a href="profiles.html#cb9-10" tabindex="-1"></a>df_split <span class="ot">&lt;-</span></span>
<span id="cb9-11"><a href="profiles.html#cb9-11" tabindex="-1"></a>  df_field <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="profiles.html#cb9-12" tabindex="-1"></a>  rsample<span class="sc">::</span><span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">strata =</span> cluster)</span>
<span id="cb9-13"><a href="profiles.html#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="profiles.html#cb9-14" tabindex="-1"></a>train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(df_split)</span>
<span id="cb9-15"><a href="profiles.html#cb9-15" tabindex="-1"></a>test <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(df_split)</span>
<span id="cb9-16"><a href="profiles.html#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="profiles.html#cb9-17" tabindex="-1"></a><span class="co"># Cross validation folds from training dataset</span></span>
<span id="cb9-18"><a href="profiles.html#cb9-18" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">567</span>)</span>
<span id="cb9-19"><a href="profiles.html#cb9-19" tabindex="-1"></a>folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(train, <span class="at">strata =</span> cluster)</span>
<span id="cb9-20"><a href="profiles.html#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="profiles.html#cb9-21" tabindex="-1"></a><span class="co"># pre- processing</span></span>
<span id="cb9-22"><a href="profiles.html#cb9-22" tabindex="-1"></a>cust_rec <span class="ot">&lt;-</span></span>
<span id="cb9-23"><a href="profiles.html#cb9-23" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(cluster <span class="sc">~</span> ., <span class="at">data =</span> train) <span class="sc">%&gt;%</span></span>
<span id="cb9-24"><a href="profiles.html#cb9-24" tabindex="-1"></a>  <span class="co">#  update_role(customerID, new_role = &quot;ID&quot;) %&gt;%</span></span>
<span id="cb9-25"><a href="profiles.html#cb9-25" tabindex="-1"></a>  <span class="co">#  step_corr(all_numeric()) %&gt;%</span></span>
<span id="cb9-26"><a href="profiles.html#cb9-26" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_corr</span>(recipes<span class="sc">::</span><span class="fu">all_numeric</span>(), <span class="at">threshold =</span> <span class="fl">0.7</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-27"><a href="profiles.html#cb9-27" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(recipes<span class="sc">::</span><span class="fu">all_numeric</span>()) <span class="sc">%&gt;%</span> <span class="co"># filter zero variance</span></span>
<span id="cb9-28"><a href="profiles.html#cb9-28" tabindex="-1"></a>  <span class="co"># recipes::step_normalize(recipes::all_numeric()) %&gt;%</span></span>
<span id="cb9-29"><a href="profiles.html#cb9-29" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">step_integer</span>(recipes<span class="sc">::</span><span class="fu">all_nominal</span>())</span>
<span id="cb9-30"><a href="profiles.html#cb9-30" tabindex="-1"></a></span>
<span id="cb9-31"><a href="profiles.html#cb9-31" tabindex="-1"></a><span class="co"># define model</span></span>
<span id="cb9-32"><a href="profiles.html#cb9-32" tabindex="-1"></a>xgb_spec <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">boost_tree</span>(</span>
<span id="cb9-33"><a href="profiles.html#cb9-33" tabindex="-1"></a>  <span class="at">trees =</span> <span class="dv">500</span>,</span>
<span id="cb9-34"><a href="profiles.html#cb9-34" tabindex="-1"></a>  <span class="at">tree_depth =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>(),</span>
<span id="cb9-35"><a href="profiles.html#cb9-35" tabindex="-1"></a>  <span class="at">min_n =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>(),</span>
<span id="cb9-36"><a href="profiles.html#cb9-36" tabindex="-1"></a>  <span class="at">loss_reduction =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>(), <span class="do">## first three: model complexity</span></span>
<span id="cb9-37"><a href="profiles.html#cb9-37" tabindex="-1"></a>  <span class="at">sample_size =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>(), </span>
<span id="cb9-38"><a href="profiles.html#cb9-38" tabindex="-1"></a>  <span class="at">mtry =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>(), <span class="do">## randomness</span></span>
<span id="cb9-39"><a href="profiles.html#cb9-39" tabindex="-1"></a>  <span class="at">learn_rate =</span> hardhat<span class="sc">::</span><span class="fu">tune</span>() <span class="do">## step size</span></span>
<span id="cb9-40"><a href="profiles.html#cb9-40" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-41"><a href="profiles.html#cb9-41" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">&quot;xgboost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-42"><a href="profiles.html#cb9-42" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span>
<span id="cb9-43"><a href="profiles.html#cb9-43" tabindex="-1"></a></span>
<span id="cb9-44"><a href="profiles.html#cb9-44" tabindex="-1"></a><span class="co"># Passing to workflow formula and Model specification</span></span>
<span id="cb9-45"><a href="profiles.html#cb9-45" tabindex="-1"></a>xgb_wf <span class="ot">&lt;-</span></span>
<span id="cb9-46"><a href="profiles.html#cb9-46" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-47"><a href="profiles.html#cb9-47" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_formula</span>(cluster <span class="sc">~</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb9-48"><a href="profiles.html#cb9-48" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(xgb_spec)</span>
<span id="cb9-49"><a href="profiles.html#cb9-49" tabindex="-1"></a></span>
<span id="cb9-50"><a href="profiles.html#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="profiles.html#cb9-51" tabindex="-1"></a><span class="co"># tuning</span></span>
<span id="cb9-52"><a href="profiles.html#cb9-52" tabindex="-1"></a>xgb_grid <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">grid_latin_hypercube</span>(</span>
<span id="cb9-53"><a href="profiles.html#cb9-53" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">tree_depth</span>(),</span>
<span id="cb9-54"><a href="profiles.html#cb9-54" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">min_n</span>(),</span>
<span id="cb9-55"><a href="profiles.html#cb9-55" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">loss_reduction</span>(),</span>
<span id="cb9-56"><a href="profiles.html#cb9-56" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="fu">sample_prop</span>(),</span>
<span id="cb9-57"><a href="profiles.html#cb9-57" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">finalize</span>(dials<span class="sc">::</span><span class="fu">mtry</span>(), train),</span>
<span id="cb9-58"><a href="profiles.html#cb9-58" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">learn_rate</span>(),</span>
<span id="cb9-59"><a href="profiles.html#cb9-59" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">20</span></span>
<span id="cb9-60"><a href="profiles.html#cb9-60" tabindex="-1"></a>)</span>
<span id="cb9-61"><a href="profiles.html#cb9-61" tabindex="-1"></a></span>
<span id="cb9-62"><a href="profiles.html#cb9-62" tabindex="-1"></a><span class="co">#doParallel::registerDoParallel(cores = 6)</span></span>
<span id="cb9-63"><a href="profiles.html#cb9-63" tabindex="-1"></a><span class="co">#set.seed(891)</span></span>
<span id="cb9-64"><a href="profiles.html#cb9-64" tabindex="-1"></a><span class="co">#xgb_res &lt;- tune::tune_grid(</span></span>
<span id="cb9-65"><a href="profiles.html#cb9-65" tabindex="-1"></a><span class="co">#  xgb_wf,</span></span>
<span id="cb9-66"><a href="profiles.html#cb9-66" tabindex="-1"></a><span class="co">#  resamples = folds,</span></span>
<span id="cb9-67"><a href="profiles.html#cb9-67" tabindex="-1"></a><span class="co">#  grid = xgb_grid,</span></span>
<span id="cb9-68"><a href="profiles.html#cb9-68" tabindex="-1"></a><span class="co">#  control = tune::control_grid(save_pred = TRUE)</span></span>
<span id="cb9-69"><a href="profiles.html#cb9-69" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb9-70"><a href="profiles.html#cb9-70" tabindex="-1"></a></span>
<span id="cb9-71"><a href="profiles.html#cb9-71" tabindex="-1"></a><span class="co">#readr::write_rds(xgb_res, file = paste0(system.file(&quot;model-outputs&quot;, package = &quot;timor.nutrients&quot;), &quot;/xgb_res.rds&quot;))</span></span>
<span id="cb9-72"><a href="profiles.html#cb9-72" tabindex="-1"></a></span>
<span id="cb9-73"><a href="profiles.html#cb9-73" tabindex="-1"></a><span class="co"># dysplay tuning parameters</span></span>
<span id="cb9-74"><a href="profiles.html#cb9-74" tabindex="-1"></a><span class="co"># xgb_res %&gt;%</span></span>
<span id="cb9-75"><a href="profiles.html#cb9-75" tabindex="-1"></a><span class="co">#  tune::collect_metrics() %&gt;%</span></span>
<span id="cb9-76"><a href="profiles.html#cb9-76" tabindex="-1"></a><span class="co">#  dplyr::filter(.metric == &quot;roc_auc&quot;) %&gt;%</span></span>
<span id="cb9-77"><a href="profiles.html#cb9-77" tabindex="-1"></a><span class="co">#  dplyr::select(mean, mtry:sample_size) %&gt;%</span></span>
<span id="cb9-78"><a href="profiles.html#cb9-78" tabindex="-1"></a><span class="co">#  tidyr::pivot_longer(mtry:sample_size,</span></span>
<span id="cb9-79"><a href="profiles.html#cb9-79" tabindex="-1"></a><span class="co">#                      names_to = &quot;parameter&quot;,</span></span>
<span id="cb9-80"><a href="profiles.html#cb9-80" tabindex="-1"></a><span class="co">#                      values_to = &quot;value&quot;</span></span>
<span id="cb9-81"><a href="profiles.html#cb9-81" tabindex="-1"></a><span class="co">#  ) %&gt;%</span></span>
<span id="cb9-82"><a href="profiles.html#cb9-82" tabindex="-1"></a><span class="co">#  ggplot(aes(value, mean, color = parameter)) +</span></span>
<span id="cb9-83"><a href="profiles.html#cb9-83" tabindex="-1"></a><span class="co">#  geom_point(show.legend = FALSE) +</span></span>
<span id="cb9-84"><a href="profiles.html#cb9-84" tabindex="-1"></a><span class="co">#  facet_wrap(~parameter, scales = &quot;free_x&quot;)</span></span>
<span id="cb9-85"><a href="profiles.html#cb9-85" tabindex="-1"></a></span>
<span id="cb9-86"><a href="profiles.html#cb9-86" tabindex="-1"></a></span>
<span id="cb9-87"><a href="profiles.html#cb9-87" tabindex="-1"></a><span class="co"># tune::show_best(xgb_res, &quot;roc_auc&quot;)</span></span>
<span id="cb9-88"><a href="profiles.html#cb9-88" tabindex="-1"></a></span>
<span id="cb9-89"><a href="profiles.html#cb9-89" tabindex="-1"></a><span class="co"># select best tune</span></span>
<span id="cb9-90"><a href="profiles.html#cb9-90" tabindex="-1"></a>xgb_res <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;model-outputs&quot;</span>, <span class="at">package =</span> <span class="st">&quot;timor.nutrients&quot;</span>), <span class="st">&quot;/xgb_res.rds&quot;</span>))</span>
<span id="cb9-91"><a href="profiles.html#cb9-91" tabindex="-1"></a>best_auc <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(xgb_res, <span class="st">&quot;roc_auc&quot;</span>)</span>
<span id="cb9-92"><a href="profiles.html#cb9-92" tabindex="-1"></a></span>
<span id="cb9-93"><a href="profiles.html#cb9-93" tabindex="-1"></a>final_xgb <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(xgb_wf, best_auc)</span>
<span id="cb9-94"><a href="profiles.html#cb9-94" tabindex="-1"></a></span>
<span id="cb9-95"><a href="profiles.html#cb9-95" tabindex="-1"></a><span class="co"># final_xgb %&gt;%</span></span>
<span id="cb9-96"><a href="profiles.html#cb9-96" tabindex="-1"></a><span class="co">#  fit(data = train) %&gt;%</span></span>
<span id="cb9-97"><a href="profiles.html#cb9-97" tabindex="-1"></a><span class="co">#  hardhat::extract_fit_parsnip() %&gt;%</span></span>
<span id="cb9-98"><a href="profiles.html#cb9-98" tabindex="-1"></a><span class="co">#  vip::vip(geom = &quot;point&quot;)</span></span>
<span id="cb9-99"><a href="profiles.html#cb9-99" tabindex="-1"></a></span>
<span id="cb9-100"><a href="profiles.html#cb9-100" tabindex="-1"></a><span class="co"># fit</span></span>
<span id="cb9-101"><a href="profiles.html#cb9-101" tabindex="-1"></a>final_rs <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">last_fit</span>(final_xgb, df_split,</span>
<span id="cb9-102"><a href="profiles.html#cb9-102" tabindex="-1"></a>  <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(accuracy, roc_auc, sens, spec)</span>
<span id="cb9-103"><a href="profiles.html#cb9-103" tabindex="-1"></a>)</span>
<span id="cb9-104"><a href="profiles.html#cb9-104" tabindex="-1"></a></span>
<span id="cb9-105"><a href="profiles.html#cb9-105" tabindex="-1"></a><span class="co"># final_rs %&gt;%</span></span>
<span id="cb9-106"><a href="profiles.html#cb9-106" tabindex="-1"></a><span class="co">#  tune::collect_metrics()</span></span>
<span id="cb9-107"><a href="profiles.html#cb9-107" tabindex="-1"></a></span>
<span id="cb9-108"><a href="profiles.html#cb9-108" tabindex="-1"></a>cmat <span class="ot">&lt;-</span></span>
<span id="cb9-109"><a href="profiles.html#cb9-109" tabindex="-1"></a>  final_rs <span class="sc">%&gt;%</span></span>
<span id="cb9-110"><a href="profiles.html#cb9-110" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-111"><a href="profiles.html#cb9-111" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(cluster, .pred_class)</span>
<span id="cb9-112"><a href="profiles.html#cb9-112" tabindex="-1"></a></span>
<span id="cb9-113"><a href="profiles.html#cb9-113" tabindex="-1"></a><span class="co"># show roc curves</span></span>
<span id="cb9-114"><a href="profiles.html#cb9-114" tabindex="-1"></a>final_rs <span class="sc">%&gt;%</span></span>
<span id="cb9-115"><a href="profiles.html#cb9-115" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-116"><a href="profiles.html#cb9-116" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(cluster, <span class="fu">c</span>(.pred_1<span class="sc">:</span>.pred_5), <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-117"><a href="profiles.html#cb9-117" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="dv">1</span> <span class="sc">-</span> specificity, sensitivity, <span class="at">color =</span> .level)) <span class="sc">+</span></span>
<span id="cb9-118"><a href="profiles.html#cb9-118" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-119"><a href="profiles.html#cb9-119" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9-120"><a href="profiles.html#cb9-120" tabindex="-1"></a>  <span class="co"># geom_point()+</span></span>
<span id="cb9-121"><a href="profiles.html#cb9-121" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb9-122"><a href="profiles.html#cb9-122" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;cluster&quot;</span>)</span></code></pre></div>
<p><img src="Timor-nutrient-sensitive-fisheries-management_files/figure-html/model-settings-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="profiles.html#cb10-1" tabindex="-1"></a><span class="co"># show auc value</span></span>
<span id="cb10-2"><a href="profiles.html#cb10-2" tabindex="-1"></a>final_rs <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="profiles.html#cb10-3" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="profiles.html#cb10-4" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">roc_auc</span>(cluster, <span class="fu">c</span>(.pred_1<span class="sc">:</span>.pred_5)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="profiles.html#cb10-5" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="profiles.html#cb10-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="profiles.html#cb10-7" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">metric</th>
<th align="left">estimator</th>
<th align="right">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">roc_auc</td>
<td align="left">hand_till</td>
<td align="right">0.86</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distribution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-profiles.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Timor nutrient-sensitive fisheries management.pdf", "Timor nutrient-sensitive fisheries management.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
